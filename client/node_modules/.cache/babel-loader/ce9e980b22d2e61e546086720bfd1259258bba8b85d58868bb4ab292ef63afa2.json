{"ast":null,"code":"// src/components/ReadTab.js\nimport React,{useState,useEffect}from'react';import{useEssays}from'../context/EssayContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function ReadTab(){const{essays,likeEssay}=useEssays();const[sortBy,setSortBy]=useState('mostLiked');const[replies,setReplies]=useState({});const[newReplyContent,setNewReplyContent]=useState({});const[replyAuthor,setReplyAuthor]=useState({});const API_BASE_URL=process.env.REACT_APP_API_BASE_URL;const sortedEssays=[...essays].sort((a,b)=>sortBy==='mostLiked'?b.likes-a.likes:b.timestamp-a.timestamp);useEffect(()=>{const fetchReplies=async essayId=>{try{const response=await fetch(\"\".concat(API_BASE_URL,\"/replies/\").concat(essayId));const data=await response.json();setReplies(prevReplies=>({...prevReplies,[essayId]:data}));}catch(error){console.error('Error fetching replies:',error);}};essays.forEach(essay=>{fetchReplies(essay._id);});},[essays,API_BASE_URL]);const handleReplySubmit=async essayId=>{try{const response=await fetch(\"\".concat(API_BASE_URL,\"/replies\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({essayId,content:newReplyContent[essayId],authorName:replyAuthor[essayId]||'Anonymous'})});if(!response.ok){throw new Error('Network response was not ok');}const savedReply=await response.json();setReplies(prevReplies=>({...prevReplies,[essayId]:[...(prevReplies[essayId]||[]),savedReply]}));setNewReplyContent(prev=>({...prev,[essayId]:''}));setReplyAuthor(prev=>({...prev,[essayId]:''}));}catch(error){console.error('Error posting reply:',error);}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"select\",{onChange:e=>setSortBy(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"mostLiked\",children:\"Most Liked\"}),/*#__PURE__*/_jsx(\"option\",{value:\"mostRecent\",children:\"Most Recent\"})]}),sortedEssays.map(essay=>/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'20px',border:'1px solid #ddd',padding:'10px'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{marginBottom:'10px',fontSize:'24px',fontWeight:'bold',fontFamily:'Lekton'},children:essay.title}),/*#__PURE__*/_jsx(\"p\",{children:essay.content}),/*#__PURE__*/_jsxs(\"p\",{children:[\"By: \",essay.isAnonymous?'Anonymous':essay.authorName]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>likeEssay(essay._id),children:[\"\\uD83D\\uDC4D Like (\",essay.likes,\")\"]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Replies\"}),(replies[essay._id]||[]).map(reply=>/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'10px',padding:'5px',borderBottom:'1px solid #eee'},children:[/*#__PURE__*/_jsx(\"p\",{children:reply.content}),/*#__PURE__*/_jsx(\"p\",{children:/*#__PURE__*/_jsxs(\"i\",{children:[\"By: \",reply.authorName,\" on \",new Date(reply.timestamp).toLocaleString()]})})]},reply._id)),/*#__PURE__*/_jsx(\"textarea\",{value:newReplyContent[essay._id]||'',onChange:e=>setNewReplyContent({...newReplyContent,[essay._id]:e.target.value}),placeholder:\"Write your reply here\",style:{width:'100%',height:'80px',marginTop:'10px'}}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:replyAuthor[essay._id]||'',onChange:e=>setReplyAuthor({...replyAuthor,[essay._id]:e.target.value}),placeholder:\"Your Name (optional)\",style:{width:'100%',marginTop:'5px',padding:'5px'}}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleReplySubmit(essay._id),style:{marginTop:'5px'},children:\"Submit Reply\"})]})]},essay._id))]});}export default ReadTab;","map":{"version":3,"names":["React","useState","useEffect","useEssays","jsx","_jsx","jsxs","_jsxs","ReadTab","essays","likeEssay","sortBy","setSortBy","replies","setReplies","newReplyContent","setNewReplyContent","replyAuthor","setReplyAuthor","API_BASE_URL","process","env","REACT_APP_API_BASE_URL","sortedEssays","sort","a","b","likes","timestamp","fetchReplies","essayId","response","fetch","concat","data","json","prevReplies","error","console","forEach","essay","_id","handleReplySubmit","method","headers","body","JSON","stringify","content","authorName","ok","Error","savedReply","prev","children","onChange","e","target","value","map","style","marginBottom","border","padding","fontSize","fontWeight","fontFamily","title","isAnonymous","onClick","reply","marginTop","borderBottom","Date","toLocaleString","placeholder","width","height","type"],"sources":["/Users/lance/just650/client/src/components/ReadTab.js"],"sourcesContent":["// src/components/ReadTab.js\nimport React, { useState, useEffect } from 'react';\nimport { useEssays } from '../context/EssayContext';\n\nfunction ReadTab() {\n  const { essays, likeEssay } = useEssays();\n  const [sortBy, setSortBy] = useState('mostLiked');\n  const [replies, setReplies] = useState({});\n  const [newReplyContent, setNewReplyContent] = useState({});\n  const [replyAuthor, setReplyAuthor] = useState({});\n\n  const API_BASE_URL = process.env.REACT_APP_API_BASE_URL;\n\n  const sortedEssays = [...essays].sort((a, b) =>\n    sortBy === 'mostLiked' ? b.likes - a.likes : b.timestamp - a.timestamp\n  );\n\n  useEffect(() => {\n    const fetchReplies = async (essayId) => {\n      try {\n        const response = await fetch(`${API_BASE_URL}/replies/${essayId}`);\n        const data = await response.json();\n        setReplies((prevReplies) => ({\n          ...prevReplies,\n          [essayId]: data,\n        }));\n      } catch (error) {\n        console.error('Error fetching replies:', error);\n      }\n    };\n\n    essays.forEach((essay) => {\n      fetchReplies(essay._id);\n    });\n  }, [essays, API_BASE_URL]);\n\n  const handleReplySubmit = async (essayId) => {\n    try {\n      const response = await fetch(`${API_BASE_URL}/replies`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          essayId,\n          content: newReplyContent[essayId],\n          authorName: replyAuthor[essayId] || 'Anonymous',\n        }),\n      });\n\n      if (!response.ok) {\n        throw new Error('Network response was not ok');\n      }\n\n      const savedReply = await response.json();\n      setReplies((prevReplies) => ({\n        ...prevReplies,\n        [essayId]: [...(prevReplies[essayId] || []), savedReply],\n      }));\n      setNewReplyContent((prev) => ({ ...prev, [essayId]: '' }));\n      setReplyAuthor((prev) => ({ ...prev, [essayId]: '' }));\n    } catch (error) {\n      console.error('Error posting reply:', error);\n    }\n  };\n\n  return (\n    <div>\n      <select onChange={(e) => setSortBy(e.target.value)}>\n        <option value=\"mostLiked\">Most Liked</option>\n        <option value=\"mostRecent\">Most Recent</option>\n      </select>\n      {sortedEssays.map((essay) => (\n        <div key={essay._id} style={{ marginBottom: '20px', border: '1px solid #ddd', padding: '10px' }}>\n          <h2 style={{ marginBottom: '10px', fontSize: '24px', fontWeight: 'bold', fontFamily: 'Lekton' }}>\n            {essay.title}\n          </h2>\n          <p>{essay.content}</p>\n          <p>By: {essay.isAnonymous ? 'Anonymous' : essay.authorName}</p>\n          <button onClick={() => likeEssay(essay._id)}>\n            üëç Like ({essay.likes})\n          </button>\n          <div>\n            <h3>Replies</h3>\n            {(replies[essay._id] || []).map((reply) => (\n              <div key={reply._id} style={{ marginTop: '10px', padding: '5px', borderBottom: '1px solid #eee' }}>\n                <p>{reply.content}</p>\n                <p><i>By: {reply.authorName} on {new Date(reply.timestamp).toLocaleString()}</i></p>\n              </div>\n            ))}\n            <textarea\n              value={newReplyContent[essay._id] || ''}\n              onChange={(e) => setNewReplyContent({ ...newReplyContent, [essay._id]: e.target.value })}\n              placeholder=\"Write your reply here\"\n              style={{ width: '100%', height: '80px', marginTop: '10px' }}\n            />\n            <input\n              type=\"text\"\n              value={replyAuthor[essay._id] || ''}\n              onChange={(e) => setReplyAuthor({ ...replyAuthor, [essay._id]: e.target.value })}\n              placeholder=\"Your Name (optional)\"\n              style={{ width: '100%', marginTop: '5px', padding: '5px' }}\n            />\n            <button onClick={() => handleReplySubmit(essay._id)} style={{ marginTop: '5px' }}>\n              Submit Reply\n            </button>\n          </div>\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport default ReadTab;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}